@using TaskTracker.Blazor.Domain.DTOs

<MudPaper Class="task-card pa-3 mb-2"
          Elevation="1"
          @onclick=@(() => Navigation.NavigateTo($"/tasks/{Task.Id}"))>

    <MudText Typo=@Typo.body1
             Class="mb-2"
             Style="font-weight: 500;">
        @Task.Title
    </MudText>

    <div class="d-flex align-center gap-2 flex-wrap">
        @if (Task.Priority >= 3)
        {
            <MudChip T="string"
                     Size=@Size.Small
                     Color=@GetPriorityColor(Task.Priority)
                     Variant=@Variant.Text
                     Class="ma-0">
                @Task.PriorityName
            </MudChip>
        }

        @if (Task.DueDate.HasValue)
        {
            <MudChip T="string"
                     Size=@Size.Small
                     Icon=@Icons.Material.Filled.CalendarToday
                     Color=@GetDueDateColor(Task.DueDate.Value)
                     Class="ma-0">
                @Task.DueDate.Value.ToString("MMM dd")
            </MudChip>
        }

        @if (Task.CommentsCount > 0)
        {
            <MudChip T="string"
                     Size=@Size.Small
                     Icon=@Icons.Material.Filled.Comment
                     Variant=@Variant.Text
                     Class="ma-0">
                @Task.CommentsCount
            </MudChip>
        }

        @if (Task.AttachmentsCount > 0)
        {
            <MudChip T="string"
                     Size=@Size.Small
                     Icon=@Icons.Material.Filled.AttachFile
                     Variant=@Variant.Text
                     Class="ma-0">
                @Task.AttachmentsCount
            </MudChip>
        }
    </div>

    @if (Task.Labels != null && Task.Labels.Any())
    {
        <div class="d-flex gap-1 mt-2 flex-wrap">
            @foreach (var label in Task.Labels.Take(3))
            {
                <MudChip T="string"
                         Size=@Size.Small
                         Style=@($"background-color: {label.Color}; color: white;")
                         Variant=@Variant.Filled
                         Class="ma-0">
                    @label.Name
                </MudChip>
            }
        </div>
    }

    @if (!string.IsNullOrEmpty(Task.AssignedUserName))
    {
        <div class="mt-2 d-flex justify-end">
            <MudAvatar Size=@Size.Small
                       Color=@Color.Primary
                       Style="font-size: 12px;">
                @Task.AssignedUserName.Substring(0, 1).ToUpper()
            </MudAvatar>
        </div>
    }

</MudPaper>

